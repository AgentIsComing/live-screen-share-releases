<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Live Screen Share Desktop</title>
    <link rel="stylesheet" href="./style.css" />
  </head>
  <body>
    <main>
      <section class="card">
        <h1>Live Screen Share Desktop</h1>
        <p class="sub">Host or watch with WebRTC, including OBS Virtual Camera and custom audio input routing.</p>

        <div class="grid two">
          <label>
            Mode
            <select id="mode">
              <option value="host">Host</option>
              <option value="viewer">Viewer</option>
            </select>
          </label>

          <label>
            Room ID
            <input id="roomId" type="text" placeholder="jayde-room" />
          </label>

          <label>
            Signaling URL
            <input id="signalUrl" type="text" placeholder="wss://your-signal-server/signal" />
          </label>

          <label>
            Tunnel helper
            <button id="autoTunnel" type="button">Auto-fill from Cloudflare Tunnel</button>
          </label>

          <label>
            Connectivity
            <button id="startBackend" type="button">Start backend (signal+tunnel)</button>
            <button id="stopBackend" type="button" class="danger" disabled>Stop backend</button>
            <button id="testSignal" type="button">Test signaling endpoint</button>
            <button id="checkUpdates" type="button">Check app updates</button>
          </label>

          <label id="codeServiceWrap">
            Code service URL (Host advanced)
            <input id="codeServiceUrl" type="text" placeholder="https://live-screen-share-code-service.<subdomain>.workers.dev" />
          </label>

          <label>
            Room password
            <div class="row">
              <input id="roomPassword" type="password" placeholder="Room password" />
              <button id="publishRoom" type="button">Publish room access (host)</button>
              <button id="joinRoom" type="button">Join with room + password</button>
            </div>
            <small id="roomHint">Host sets password; viewer uses same Room ID + password.</small>
          </label>

          <label>
            Latency profile
            <select id="latencyProfile">
              <option value="ultra">Ultra (lowest delay)</option>
              <option value="low">Low</option>
              <option value="balanced">Balanced</option>
            </select>
          </label>
          <label>
            Max video bitrate
            <select id="bitrate">
              <option value="2500000">2.5 Mbps (Ultra low latency)</option>
              <option value="3500000">3.5 Mbps (Low latency)</option>
              <option value="5000000">5 Mbps</option>
              <option value="8000000">8 Mbps</option>
              <option value="12000000">12 Mbps</option>
              <option value="20000000">20 Mbps</option>
            </select>
          </label>
        </div>

        <label>
          ICE servers (JSON)
          <textarea id="iceJson" rows="4"></textarea>
        </label>

        <div id="hostPanel">
          <div class="grid two">
            <label>
              Video source
              <select id="videoSource">
                <option value="display">Display/Window capture</option>
                <option value="obs-camera">OBS Virtual Camera device</option>
              </select>
            </label>

            <label>
              Display/window source (for display mode)
              <select id="displaySource"></select>
            </label>

            <label>
              Audio mode
              <select id="audioMode">
                <option value="display">Display system audio (share prompt)</option>
                <option value="input">Audio input device only (for OBS via virtual cable)</option>
                <option value="display+input">Display audio + input device</option>
                <option value="none">No audio</option>
              </select>
            </label>

            <label>
              Camera device (for OBS camera mode)
              <select id="cameraDevice"></select>
            </label>

            <label>
              Audio input device
              <select id="audioDevice"></select>
            </label>
          </div>

          <div class="row">
            <button id="refreshDevices">Refresh devices</button>
            <button id="startHost">Start hosting</button>
            <button id="stopHost" class="danger" disabled>Stop hosting</button>
          </div>
        </div>

        <div id="viewerPanel" class="hidden">
          <div class="row">
            <button id="startViewer">Connect as viewer</button>
            <button id="stopViewer" class="danger" disabled>Disconnect</button>
          </div>
        </div>

        <p id="status" class="status"></p>
        <p id="updateStatus" class="status"></p>
        <small id="version"></small>
      </section>

      <section class="card">
        <h2>Preview / Playback</h2>
        <video id="video" autoplay playsinline controls></video>
      </section>
    </main>

    <script src="./app.js"></script>
  </body>
</html>
